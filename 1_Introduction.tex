\chapter{Introduction}
\label{Introduction}

\section{Problem Statement}
Tumor hypoxia is a condition wherein certain regions within the tumor volume are deprived of oxygen, and is caused when the tumor's blood supply system cannot keep up with the proliferation rate of its cells \cite{hockel2001tumor}. Hypoxic cells develop certain alterations in their functioning mechanisms that make them resistant to conventional modes of cancer treatment, including radiotherapy and chemotherapy, and increase metastatic spread \cite{muz2015role}, thereby resulting in poor prognosis \cite{vaupel2007hypoxia}. In radiotherapy, it would be of great value to detect these hypoxic sub-volumes during treatment planning so that the radiation dose can be adjusted accordingly to be more effective, for example, by selectively delivering higher dose to the hypoxic regions, a technique known as radiotherapy boosting. Among various non-invasive methods investigated for hypoxia detection, Positron Emission Tomography (PET) based hypoxia imaging has been the most preferred one \cite{fleming2015imaging}. PET is a molecular imaging technique that involves administration of a specific radioactive pharmaceutical contrast agent, known as radiotracer, to the patient, followed by tracking it via scanning to provide information about the status of a particular biochemical process. Hypoxia PET imaging provides, essentially, an oxygen concentration heatmap which can be overlaid on a Computer Tomography (CT) scan to provide contrast around the anatomical regions that are hypoxic. A newly developed hypoxia tracer, denoted as [$^{18}$F]HX4, has been shown to be highly effective and stable in detecting regions of tumor hypoxia \cite{sanduleanu2020hypoxia}, and the PET image acquired using this tracer is denoted as HX4-PET. HX4-PET imaging technique, however, is not widely available, is expensive and has only been used in research and clinical trials so far. 

Generative adversarial networks (GANs) have recently become a subject of investigation as a general solution to image-to-image translation problems. The Pix2pix and CycleGAN frameworks \cite{isola2017image, zhu2017unpaired} are among the early systems developed in this direction targeting paired and unpaired variants of the problem, respectively. While paired translation tasks supply spatially aligned pairs of input and target images in the training data to directly learn an input-target mapping, unpaired translation tasks do not provide paired data usually because it is either impossible, unrealistically difficult or unacceptably risky to obtain such data. In the space of medical imaging, GAN-based techniques have been widely explored for translating images of one modality into another \cite{yi2019generative}. However, since medical images are quantitative in nature that represent some underlying physical or biochemical properties of human body, and since these images are used for clinical decision making, the GAN-generated synthetic images must be representative of the patient's condition and must conform to high quality standards. Evaluation of synthetic medical images is a difficult problem and is, in many cases, application-specific. 

It would be of great benefit to patients and to the care provider if entire HX4-PET images could be synthesized from more readily available imaging modalities. FDG-PET, which indicates metabolism levels, and CT images have been shown to contain features capable of reliably predicting hypoxic regions in the tumor \cite{even2017predicting, sanduleanu2020non}, and to have the potential of circumventing the use of HX4-PET imaging. The problems tackled by this thesis project are two-fold -- (1) Synthesis of full HX4-PET images from FDG-PET and CT scans of the patients using GANs, and (2) Evaluation of different aspects of the synthetic HX4-PET images using general image quality metrics and via application-specific image analysis.



\section{Significance of the Thesis}
This work formulates the hypoxia prediction problem as an image-to-image translation task where entire 3D HX4-PET images are to be synthesized from FDG-PET and CT. We investigate both paired and unpaired GAN approaches, specifically Pix2Pix and CycleGAN, as potential solutions to this problem. CycleGAN system utilizes cycle-consistency to learn an image translation model in the absence of paired training data by simultaneously learning an input-target mapping as well as its inverse. However, since the input in our use-case is multimodal, applying CycleGAN naively to this problem may not be optimal. CycleGAN assumes the existence of a bijective function between the input and the target domains, which is violated here as it is practically impossible to precisely reconstruct both FDG-PET and CT back from a single HX4-PET. Therefore, in order to sidestep this issue, a design improvement in the CycleGAN training is proposed for this specific use-case. To our best knowledge, ours is the first work that has attempted GAN-based cross-modality medical image translation involving more than two imaging modalities.

To address the problem of evaluating synthetic HX4-PET images, we use six different metrics that measure different properties of an image, including voxel-wise difference, fidelity of the perceived structure and global intensity statistics. Since each metric has its unique strengths and drawbacks, our aim is to use metrics of different types to complement each other and reach a consensus on the models' assessment. Based on these metrics, we empirically show that the modified CycleGAN achieved remarkable improvement over the default CycleGAN, and we simultaneously validate the assessment of these metrics by performing a systematic visual inspection of the 3D synthetic images. Additionally, we investigate the applicability of these image quality metrics in tracking the stability and convergence of the CycleGAN models during training.

Finally, we perform a clinically relevant analysis of the synthetic HX4-PET images to determine their clinical value. Application-specific downstream tasks are identified from hypoxia imaging literature and applied to quantify hypoxia locally within the tumors. This is of great importance and of more interest to clinicians as a benchmark to gauge the potential of the models as an alternative solution to HX4-PET imaging to be integrated into radiotherapy practice in future. Although our quantitative results on tumor hypoxia quantification indicate no significant performance difference among the different methods, our qualitative analysis highlights the drawbacks of paired GAN approaches and suggests that unpaired methods might be more suitable for the task, given sufficient data.



\section{Research Questions}
The research questions posed initially at the time of drafting the thesis plan were slightly updated, without changing their overall theme, later when the work on the project actually began. The primary reason is that the exact specifications of the project were not provided earlier, rather only a vague formulation of the problem was given -- synthesis of Contrast-Enhanced Computed Tomography (CECT) images from CT using GANs. ``Contrast-enhanced" CT is an umbrella term that includes a variety of techniques used to selectively provide contrast enhancement to certain regions in a CT scan, ranging from using iodine-based contrast agents that improve visibility of organs like liver and pancreas by raising the radiodensity of blood to acquiring PET scans that utilize radiotracers to highlight sites of certain physiological processes like metabolism and hypoxia. Therefore, one of the main changes in the research questions was replacing the term ``CECT" with ``HX4-PET". Reasons for other question-specific changes are provided further in \ref{updated_research_questions}.


\subsection{Original}
\begin{enumerate}
    \item What measures need to be considered during evaluation to more accurately quantify the similarity of synthetic CECT images with clinically acquired ones in an unpaired image-to-image translation scenario?
    \item How reliable are deep-learning based downstream analysis approaches, such as image classification or segmentation, for evaluating synthetic CECT images?
    \item How can such application-specific validation methods be applied to assess the stability of CycleGAN training for this task and detect issues like mode collapse?
\end{enumerate}


\subsection{Updated}
\label{updated_research_questions}

\begin{enumerate}
    \item What measures need to be considered during evaluation to accurately quantify the similarity of synthetic HX4-PET images with the clinically acquired scans?
    \item How can application-specific downstream image analysis aid in evaluating the utility of synthetic HX4-PET images for tumor hypoxia measurement?
    \item To what extent can image quality metrics provide information on convergence of the GAN models during training?
\end{enumerate}

All question-specific changes were made to make the questions more sensible and meaningful. In Question 1, the phrase ``in an unpaired image-to-image translation scenario" was removed because in the medical image dataset used in this project, the ground-truth is available, especially for the validation images, and the evaluation can be performed by merely comparing the predictions with the ground-truth, whether or not the training was performed in an unpaired manner. In Question 2, the phrase ``deep-learning based downstream analysis" was replaced with ``application-specific downstream analysis" because simpler thresholding based hypoxia classification and segmentation techniques are sufficient for image analysis. Since PET images are quantitative in nature, standardized intensity thresholds are already established for the downstream tasks and have been used in previous HX4-PET related clinical studies \cite{zegers2013hypoxia, even2017predicting, sanduleanu2020hypoxia}. Using deep-learning to perform these downstream tasks would not only be unnecessary and less reproducible, but also infeasible due to the small size of the dataset. This question now focuses on the tumor region and the value that synthetic HX4-PET image can provide in a clinical scenario in predicting hypoxia patterns within this region, instead of focusing on the overall quality and perfectness of the full image. This is reasonable because the tumor region is already delineated prior to HX4-PET acquisition. In Question 3, the phrase ``application-specific validation methods" was replaced with ``image quality metrics" because otherwise, the question would be invalid. This reason being that ``application-specific methods" implies hypoxia analysis methods (which is addressed in Question 2), which are not suitable for measuring the overall quality of the full synthetic HX4-PET images since the tumor size is much smaller than the size of the full image. To decide whether or not a GAN model is converging during training, one needs to check the overall quality of the its generated samples. Therefore, this question can now be viewed as an extension of Question 1 and as being complementary to Question 2. 